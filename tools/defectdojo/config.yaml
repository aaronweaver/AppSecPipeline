defectdojo:
  version: AppSecPipeline 0.5.0
  name: DefectDojo
  tags:
    - "Vulnerability Management"
    - "Report Consumer"
  type: "collector"
  description: "DefectDojo is a security program and vulnerability management tool. DefectDojo allows you to manage your application security program, maintain product and application information, schedule scans, triage vulnerabilities and push findings into defect trackers. Consolidate your findings into one source of truth with DefectDojo."
  docker: "appsecpipeline/base-tools"
  url: https://github.com/OWASP/django-DefectDojo
  documentation: http://defectdojo.readthedocs.io/en/latest/
  parameters:
   - "DOJO_API_KEY"
   - "DOJO_HOST"
   - "DOJO_PRODUCT_ID"
   - "DOJO_PROXY"
   - "BUILD_ID"
   - "DOJO_ENGAGEMENT_ID"
   - "DOJO_DIR"
  commands:
    parameters: "dir : Directory of security tool output."
    pre:
    exec: "python /usr/bin/appsecpipeline/tools/defectdojo/dojo_ci_cd.py --dir=$DOJO_DIR --api_key=$DOJO_API_KEY --host=$DOJO_HOST --product=$DOJO_PRODUCT_ID"
    shell: False
    post:
    report:
    reportname:
    post:
    junit:
  profiles:
    all: "--build_id=$BUILD_ID --closeengagement"
    close_engagement: "--engagement=$DOJO_ENGAGEMENT_ID --closeengagement"
    engagement: "--engagement=$DOJO_ENGAGEMENT_ID"
    all_proxy: "--proxy=$DOJO_PROXY --build_id=$BUILD_ID"
