version: AppSecPipeline 0.5.0

#Profile definition of what tools to run for a particular application
profiles:
  sourcecode:
    pipeline:
      - tool: "git"
        profile: "clone"
      - tool: "cloc"
        profile: "all"
      - tool: "checkmarx"
        profile: "all"
      - tool: "bandit"
        profile: "tuned"
      - tool: "brakeman"
        profile: "tuned"
      - tool: "retirejs"
        profile: "all"
      - tool: "defectdojo"
        profile: "all"

  standard:
   - tool: "cloc"
     profile: "all"
   - tool: "nikto"
     profile: "fast"
   - tool: "arachni"
     profile: "xss"
   - tool: "bandit"
     profile: "tuned"
   - tool: "brakeman"
     profile: "tuned"
   - tool: "retirejs"
     profile: "all"
   - tool: "defectdojo"
     profile: "all"

  production:
    startup:
      tool: prepenv
      profile: all
    runevery:
      tool: defectdojo
      profile: engagement
    final:
      tool: defectdojo
      profile: close_engagement
    pipeline:
      - tool: "zap"
        profile: "quick"
      - tool: "nmap"
        profile: "quick"
      - tool: "ssllabs"
        profile: "all"

  ssllabs:
   - tool: "ssllabs"
     profile: "all"

  tenableio:
    pipeline:
     - tool: "tenableio"
       profile: "all"

  wpscan:
    pipeline:
     - tool: "wpscan"
       profile: "all_enumeration"

  nmap:
    pipeline:
     - tool: "nmap"
       profile: "quick"

  defectdojo:
   - tool: "defectdojo"
     profile: "all"

  dynamic:
   - tool: "nikto"
     profile: "tuned"
   - tool: "arachni"
     profile: "xss"
   - tool: "defectdojo"
     profile: "all"

  static:
   - tool: "cloc"
     profile: "all"
   - tool: "bandit"
     profile: "tuned"
   - tool: "brakeman"
     profile: "tuned"
   - tool: "retirejs"
     profile: "all"
     finding-severity: #Only import issues from retireJs with a severity of Critical
       - "Critical"
   - tool: "snyk"
     profile: "all"
   - tool: "dependency-check"
     profile: "all"
   - tool: "defectdojo"
     profile: "all"

  analyze-code:
   - tool: "cloc"
     profile: "all"

#Global Import issue threshold, minimum severity
finding-severity:
  - "Medium"

#Define which profile to run based off of a code checkin
deployment:
  master: fast
  devel: sast
  pre-prod: standard
